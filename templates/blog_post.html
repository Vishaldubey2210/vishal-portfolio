{% extends 'base.html' %}

{% block title %}Blog Post | Vishal Kumar{% endblock %}

{% block content %}
<section class="py-5 mt-5">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <div class="glass-effect p-5">
                    <div class="text-center mb-5">
                        <h1 class="display-4 fw-bold gradient-text mb-3" id="post-title">Loading...</h1>
                        <div class="d-flex justify-content-center align-items-center gap-3">
                            <span class="text-muted" id="post-author"></span>
                            <span class="text-muted">â€¢</span>
                            <span class="text-muted" id="post-date"></span>
                        </div>
                    </div>

                    <div id="post-content" class="text-muted mb-4">
                        <div class="text-center">
                            <div class="loading"></div>
                            <p class="mt-3">Loading blog post...</p>
                        </div>
                    </div>

                    <div id="post-tags" class="d-flex flex-wrap gap-2 mb-4"></div>

                    <hr class="my-4">

                    <div class="text-center">
                        <a href="/blog" class="btn btn-outline-primary">
                            <i class="fas fa-arrow-left me-2"></i>Back to Blog
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    async function loadBlogPost() {
        const slug = '{{ slug }}';
        
        try {
            const response = await fetch('/api/blogs');
            const data = await response.json();
            const post = data.blogs.find(b => b.slug === slug);
            
            if (post) {
                document.getElementById('post-title').textContent = post.title;
                document.getElementById('post-author').textContent = post.author;
                document.getElementById('post-date').textContent = new Date(post.publishedAt).toLocaleDateString();
                document.getElementById('post-content').innerHTML = `<p>${post.content}</p>`;
                document.getElementById('post-tags').innerHTML = post.tags.map(tag => 
                    `<span class="badge-custom">${tag}</span>`
                ).join('');
            } else {
                document.getElementById('post-content').innerHTML = `
                    <div class="alert alert-warning text-center">
                        <i class="fas fa-exclamation-triangle fa-3x mb-3"></i>
                        <h4>Blog post not found</h4>
                        <p>This blog post doesn't exist or has been removed.</p>
                    </div>
                `;
            }
        } catch (error) {
            console.error('Error loading blog post:', error);
        }
    }

    loadBlogPost();
</script>
{% endblock %}
